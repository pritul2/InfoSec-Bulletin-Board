# Web_Security

http://fiona.utdallas.edu/~pmd220000/hackme/index.php.  [Requires UTD VPN to access]  
  
  
<img width="1325" alt="1" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/46287c1d-3c30-4ada-aa8a-8d947a2286ed">
<img width="1325" alt="2" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/dca8901a-0e4e-4134-93dd-0679e73e25b6">
<img width="1325" alt="3" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/14d6f4a5-e0fa-4c81-95ce-22ea219985b9">
<img width="1325" alt="4" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/eda3b904-67c5-491a-b905-0b53970cb8e0">
<img width="1325" alt="5" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/16ab4304-6a2b-40ed-9406-203178821c3c">
<img width="1325" alt="6" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/0c80324f-ad53-4a39-8be0-33bcdcb9cdba">
<img width="1325" alt="6 7" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/44849153-0b6e-402a-abf6-0a5cb1e91b50">
<img width="1325" alt="7" src="https://github.com/pritul2/InfoSec-Bulletin-Board/assets/41751718/0dd9b339-7cda-4e96-95d1-6e3ebd6be197">

## Preventing XSS attack
To prevent Cross-Site Scripting (XSS) attacks, the htmlspecialchars function is used which 
encode any user input that is displayed on the website. This function converts special 
characters, such as < and >, to their corresponding HTML entities, such as &lt; and &gt;, 
which prevents the browser from interpreting them as HTML tags. By encoding user input in 
this way, we ensure that any malicious scripts that an attacker may have injected into the 
website will be converted to harmless text, thus protecting users from harm.
I have sanitized the input inside the post.php as,
$_POST['title'] = htmlspecialchars(trim($_POST['title']));
$_POST['message'] = htmlspecialchars($_POST['message']);
The echo statement present inside the show.php is also sanitized as,
<?php echo htmlspecialchars($thisthread[message]) ?>
The output over bulletin board is now sanitized. Where, the less-than symbol (<) is converted 
to &lt;, the greater-than symbol (>) is converted to &gt;, and the double-quote character (") 
is converted to &quot;. This ensures that the script is displayed as plain text in the browser 
and does not get executed as HTML or JavaScript code.  
  
## Preventing XSRF attack
1. CSRF tokens: The first method to prevent XSRF attacks is to use CSRF tokens. A 
CSRF token is a random value generated by the server and included in the response 
sent to the client. The client then includes this token in subsequent requests to the 
server. The server verifies that the token in the request matches the token that was 
sent to the client. If the tokens don't match, the server can reject the request.
To implement this method in hackme, the application should generate a unique CSRF 
token for each user session and include it in every form and php request. The token 
should be cryptographically random, long enough, and not guessable. When the 
server receives a request, it should verify that the token in the request matches the 
token that was sent to the client. This will prevent XSRF attacks because the attacker 
won't be able to forge a valid CSRF token and the server will reject the request.   
   
2. Captcha: The second method to prevent XSRF attacks is to use Captcha. A Captcha is 
a challenge-response test used to determine whether the user is human or not. 
Captchas can prevent automated scripts from submitting forms and requests to the 
server. There are many different Captcha implementations available, both free and 
commercial. Some popular options include Google reCAPTCHA, hCaptcha, and Captcha by BestWebSoft. Captcha can help prevent XSRF attacks by making it more 
difficult for attackers to automate the submission of forms and requests to the server. 
Since Captcha challenges require human intervention, attackers are unable to use 
automated scripts to generate valid Captcha responses. As a result, XSRF attacks are 
less likely to be successful when Captcha is used.   
   
3. SameSite Attribute: The SameSite attribute on cookies in hackme, can prevent XSRF 
attacks by ensuring that cookies are only sent in requests that originate from the same 
site as the cookie was set on. This prevents attackers from using stolen cookies to 
send requests to a different site, which is a common technique used in XSRF attacks. 
By using the "Strict" mode, the cookie is only sent in same-site requests, providing 
maximum protection against XSRF attacks.   
   

## Preventing SQL Injection

One method is input validation that is already implemented during Password 
Management which gives error if it does not matches the regular expression.
preg_match('/^[a-zA-Z0-9]+$/')  
   
Another method that I implemented is to sanitize the user input using 
mysql_real_escape_string(). It converts any special characters in the string are 
replaced with their corresponding escape sequences.
$username = mysql_real_escape_string($_POST['username']);
